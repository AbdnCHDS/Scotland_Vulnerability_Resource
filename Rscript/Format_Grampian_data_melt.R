###################################
##### format processed the Grampian (Scotland) data set

### libraries
library(reshape2)

##loading data
setwd("~/grampian_data/Processed_data/")
dir()
df_scotland <- read.csv(dir()[1]) # lazy typing the name

### melt it down
# melt is good for plotting

# looking at the column names
colnames(df_scotland)
# we need to first 6 columns as id.var for melt

# storing those names in a vector. So, I don't need to copy past them.
var_names <-colnames(df_scotland)[1:6]
var_names

sapply(df_scotland, function(x) sum(is.na(x)))

df_scotland.melt <- melt(df_scotland, id.vars = c(var_names[1],var_names[2],var_names[3],var_names[4],var_names[5], var_names[6]) )
## >5 million rows ....
sapply(df_scotland.melt, function(x) sum(is.na(x)))
## the two data zone with out postcode create the new 68 NA 2 * 34 columns



### second part of the script. I want to add more of the SIMD information to the data set

## loading data
##loading data
setwd("~/grampian_data/Raw_data/")
dir()
df_SIMD.IndiDesc <- read.csv(dir()[4]) # lazy typing the name 

#We do not new the last column 
df_SIMD.IndiDesc<- df_SIMD.IndiDesc[4:37,1:3]

## here I am checking the variable names. Because the previous merge resulted in a lot of NA
# sort() sorts the names alphabetically 
A <- sort(levels(as.factor(df_scotland.melt$variable)))
B <- sort(levels(as.factor(df_SIMD.IndiDesc$Column)))

# Are A & B identical?
A==B
# Show me which one are not
A[!A==B]
B[!A==B]

#fucking typos!

test<- merge(df_scotland.melt, df_SIMD.IndiDesc, by.x = "variable", by.y = "Column", all.x = TRUE)
<<<<<<< HEAD
<<<<<<< HEAD

sapply(df_scotland.melt, function(x) sum(is.na(x)))

=======

sapply(df_scotland.melt, function(x) sum(is.na(x)))
>>>>>>> bce4c5002ccafc34dd25992ac420f3df41606fcf
=======

sapply(df_scotland.melt, function(x) sum(is.na(x)))
